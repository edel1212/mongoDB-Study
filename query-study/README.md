# MongoDB Query Study

```properties
# â„¹ï¸ Dockerë¥¼ ì‚¬ìš©í•´ì„œ ì‹¤í–‰í•¨
#   - Mongo Compass GUI Toolì„ í™œìš©í•˜ì—¬ í™•ì¸
```

## Set-Up
### MongoDB ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ
`docker pull mongo`

### Container ìƒì„±
```shell
docker run -d --name mongodb -v C:\Users\edel1\Desktop\docker-volume\mongo:/data/db -e MONGO_INITDB_ROOT_USERNAME=root -e MONGO_INITDB_ROOT_PASSWORD=123 -p 27017:27017 mongo
```
- ì •ìƒ ë™ì‘ í™•ì¸ ë°©ë²• ì•„ë˜ ë§í¬ í´ë¦­ ì‹œ í™•ì¸ ê°€ëŠ¥í•¨
    - `http://localhost:{ì§€ì • í¬íŠ¸ë²ˆí˜¸}`

### Mongo DB ì ‘ì†
- ì»¨í…Œì´ë„ˆ ì ‘ê·¼
    - `docker exec -it {{containerName}} /bin/bash`
- MongoDB ì ‘ì†
    - `mongosh -u root -p`

## Database

### Database ëª©ë¡ í™•ì¸
- `show dbs`
    - í•´ë‹¹ ëª…ë ¤ì–´ ì‚¬ìš©ì‹œ ë¯¸ë¦¬ ë§Œë“¤ì–´ì§„ 3ê°œì˜ Databaseë¥¼ í™•ì¸ í•  ìˆ˜ ìˆìŒ
    -
    ![img.png](img.png)

    - ê°ê°ì˜ ì„¤ëª…
        - admin
            - ê´€ë¦¬ìš© ë°ì´í„°ë² ì´ìŠ¤ (ê¶Œí•œ ë° í´ëŸ¬ìŠ¤í„° ì„¤ì •). ë£¨íŠ¸ ë°ì´í„°ë² ì´ìŠ¤ë¡œ ì‚¬ìš©
            - ì‹œìŠ¤í…œ ìˆ˜ì¤€ì˜ ê´€ë¦¬ ì‘ì—…(ì‚¬ìš©ì ê´€ë¦¬, ê¶Œí•œ ì„¤ì • ë“±)ì€ ëŒ€ë¶€ë¶„ admin ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ì´ë£¨ì–´ì§
            - ì‚¬ìš©ì ì¸ì¦
                - ì‚¬ìš©ìê°€ admin ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ì¸ì¦ë˜ë©´, MongoDB ì¸ìŠ¤í„´ìŠ¤ ì „ì²´ì— ëŒ€í•œ ê¶Œí•œì„ ê°€ì§ˆ ìˆ˜ ìˆìŒ
                - ì˜ˆ) root ì—­í• ì„ ê°€ì§„ ì‚¬ìš©ìë¥¼ admin ë°ì´í„°ë² ì´ìŠ¤ì— ì¶”ê°€í•˜ë©´, ì´ ì‚¬ìš©ìëŠ” **ëª¨ë“  ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ê´€ë¦¬**í•  ìˆ˜ ìˆìŒ
            - í´ëŸ¬ìŠ¤í„° ê´€ë¦¬
                - ë³µì œë³¸ ì„¸íŠ¸(replica set), ìƒ¤ë“œ í´ëŸ¬ìŠ¤í„°(sharded cluster) ê´€ë¦¬ì™€ ê°™ì€ ê³ ê¸‰ ì‘ì—…ë„ admin ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ì„¤ì •
            - ì„œë²„ ì •ë³´ ì €ì¥
                - ì¼ë¶€ ì‹œìŠ¤í…œ ì •ë³´ì™€ ì„œë²„ ìƒíƒœê°€ admin ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥ë©ë‹ˆë‹¤.
        - local
            - ì„œë²„ë³„ ë°ì´í„°ë² ì´ìŠ¤.
            - ë³µì œë³¸ ì„¸íŠ¸ ì„¤ì • ë° ë³µì œë˜ì§€ ì•ŠëŠ” ë°ì´í„°ë¥¼ ì €ì¥.
        - config:
            - ìƒ¤ë“œ í´ëŸ¬ìŠ¤í„° í™˜ê²½ì—ì„œ ë©”íƒ€ë°ì´í„°ë¥¼ ì €ì¥.

### Database ìƒì„±
- `use {ìƒì„±í•˜ê³  ì‹¶ì€ ë°ì´í„° ë² ì´ìŠ¤ëª…}`
    - ì¡´ì¬í•˜ì§€ ì•ŠëŠ” Databaseë¥¼ ì„ íƒí•´ë„ **ì—ëŸ¬ê°€ ë‚˜ì§€ ì•ŠìŒ**
        - ë°ì´í„°ë² ì´ìŠ¤ "ì•”ì‹œì  ìƒì„±" ìƒíƒœì´ê¸° ë•Œë¬¸ì„ MongoDBëŠ” Collectionì„ ì¶”ê°€ ì‹œ ì§„ì§œ Databaseê°€ ìƒì„±ëœë‹¤.
    - "ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ìƒì„±í•œë‹¤"ê¸°ë³´ë‹¤ëŠ” "ì„ íƒí•œë‹¤"ëŠ” ì˜ë¯¸í•¨.

### Database ì‚­ì œ
> ì‚­ì œí•  Database ì´ë™
- `db.dropDatabase();'

### Database í™•ì¸
- í˜„ì¬ Database í™•ì¸
    - `db`
- ë‚´ê°€ ë§Œë“  Database List í™•ì¸
    - `show dbs`

<hr/>

## ê³„ì •

### Role ì¢…ë¥˜

| ì—­í•  (Role)      | ì„¤ëª…                                                          |
|-------------------|---------------------------------------------------------------|
| `read`           | ì§€ì •ëœ ë°ì´í„°ë² ì´ìŠ¤ì— ëŒ€í•œ ì½ê¸° ê¶Œí•œ                          |
| `readWrite`      | ì§€ì •ëœ ë°ì´í„°ë² ì´ìŠ¤ì— ëŒ€í•œ ì½ê¸° ë° ì“°ê¸° ê¶Œí•œ                  |
| `dbAdmin`        | ë°ì´í„°ë² ì´ìŠ¤ ê´€ë¦¬ ê¶Œí•œ (ì¸ë±ìŠ¤ ê´€ë¦¬, í†µê³„ ì¡°íšŒ ë“±)            |
| `userAdmin`      | ì‚¬ìš©ì ê´€ë¦¬ ê¶Œí•œ                                              |
| `clusterAdmin`   | í´ëŸ¬ìŠ¤í„° ê´€ë¦¬ ê¶Œí•œ                                           |
| `root`           | ëª¨ë“  ê¶Œí•œ (ìŠˆí¼ìœ ì €)                                         |


### ê³„ì • ìƒì„±
- admin Database ì„ íƒ
    - `use admin`
- ê³„ì • ìƒì„±
    - **"db"ê°€ "admin"** ì´ê¸°ì— **ëª¨ë“  Databaseì— ê¶Œí•œ**ì„ ê°–ëŠ”ë‹¤
  ```javascript
  db.createUser(
  {
    user: "yoo",
    pwd:  "123",
    roles: [
    	{ "role" : "root", "db" : "admin" },
	]
  }
  ```

### ê³„ì • ì‚­ì œ
> ì‚­ì œí•  ëŒ€ìƒì´ ìˆëŠ” Database ì„ íƒ
- `db.dropUser("{{ì‚­ì œ ëŒ€ìƒ ID}}");`

### ê³„ì • ì •ë³´ ìˆ˜ì •
> ë³€ê²½í•  ëŒ€ìƒì´ ìˆëŠ” Database ì„ íƒ
- ```javascript
  db.updateUser("{{ëŒ€ìƒ ID}}", {
    pwd: "{{ë³€ê²½í•  PW}}", // ë³€ê²½í•  ë¹„ë°€ë²ˆí˜¸ - optional
    roles: [ { role: "{{ì§€ì • ê¶Œí•œ}}", db: "<database_name>" } ] // ë³€ê²½í•  ê¶Œí•œ - optional
  });
  ```


### ê³„ì • ëª©ë¡ í™•ì¸
- `db.getUsers()`

<hr/>

## Collection (Table)

### Collection ìƒì„±
- ëª…ë ¹ì–´ : `db.createCollection(name, [options]) `
- ê¸°ë³¸ ìƒì„±
    - `db.createCollection("ìƒì„±í•  Collectioëª…")`
- ì˜µì…˜ ì¶”ê°€ ìƒì„±
    - ì˜µì…˜ ì¢…ë¥˜
        -  capped :  true ë¡œ ì„¤ì • ì‹œ **ê³ ì •ëœ í¬ê¸°(fixed size)ë¥¼ ê°€ì§„ Collectionìœ¼ë¡œ ë§Œë“¤ì–´ì§**
            -  size ê°€ ì´ˆê³¼ë˜ë©´ **ê°€ì¥ ì˜¤ë˜ëœ ë°ì´í„°ë¥¼ ë®ì–´ ì”Œì›€**
                - trueë¡œ ì„¤ì •í•˜ë©´ size ê°’ì„ ê¼­ ì„¤ì •í•´ì•¼ í•¨
            - autoIndexId : trueë¡œ ì„¤ì •í•˜ë©´, _id í•„ë“œì— **indexë¥¼ ìë™ìœ¼ë¡œ ìƒì„±** (Default : false)
            - size :  Capped collection ì‚¬ìš© ì‹œ ì»¬ë ‰ì…˜ì˜ ìµœëŒ€ ì‚¬ì´ì¦ˆ(maximum size)ë¥¼ ~ bytesë¡œ ì§€ì •
                - max :  COllectionì— **ì¶”ê°€ í•  ìˆ˜ ìˆëŠ” ìµœëŒ€ ê°¯ìˆ˜ë¥¼ ì„¤ì •**
    -  ```javascript
    	   db.createCollection("articles", {
		capped: true,
		autoIndex: true,
		size: 6142800,
		max: 10000
           })
	   ```

### Collection ì‚­ì œ
- ëª…ë ¹ì–´ : `db.Collectionëª….drop() `

## Document (Row - ë°ì´í„°)

### Document ì¶”ê°€(Insert)
```properties
# â„¹ï¸ Document Insert ì‹œ ìë™ìœ¼ë¡œ _idê°€ ì¦ê°€ë˜ëŠ”ê²ƒì„ í™•ì¸ ìˆë‹¤.
#    - í•´ë‹¹ ê°’ì€ ê°’ì„ ê°ê°ì˜ Documentë¥¼ ì‹ë³„í•˜ê¸° ìœ„í•œ PKì´ë©° í•„ìˆ˜ê°’ì´ë‹¤.
#      ã„´ _Idë¥¼ ì§€ì • ì£¼ì… ê°€ëŠ¥í•˜ë‚˜ ì¤‘ë³µëœ ê°’ì€ ë¶ˆê°€ëŠ¥   
#          ã„´ db.users.insertOne({{ "_id": "Hi_Im_yoo", "name": "Alice", })
```
- ëª…ë ¹ì–´ : `db.COLLECTION_NAME.insertOne(document)` , `db.COLLECTION_NAME.insertMany(document)`

    - Ex)  `db.foo.insertOne({"name": "ìœ ì •í˜¸", "age": 120})` ,  `db.foo.insertMany([ {"name": "ê°", "age": 20}, {"name": "ì‚¬ê³¼", "age": 30} ])`

### Document ì¡°íšŒ
```properties
# â„¹ï¸ pretty()ë¥¼ ë’¤ì— ë¶™ì´ë©´ ë³´ê¸° ì¢‹ê²Œ ì •ë¦¬ ë˜ì–´ ë‚˜ì˜´
#   ã„´> Ex) db.COLLECTION_NAME.find([OPTIONS]).pretty()ê°€ëŠ¥í•˜ë‹¤
```
- ê¸°ë³¸ ì¡°íšŒ ëª…ë ¹ì–´
    - ì „ì²´ ì¡°íšŒ  `db.COLLECTION_NAME.find([OPTIONS])` 
        - EX)
            -  `db.foo.find();` :  ì „ì²´ ì¡°íšŒ 
    - ë‹¨ê±´ ì¡°íšŒ  `db.COLLECTION_NAME.findOne([OPTIONS]) ` 

### projection Option
```properties
# â„¹ï¸ find({ where ì˜µì…˜ }, {  ì¡°íšŒ í•„ë“œ ì˜µì…˜ }) ë©”ì†Œë“œì˜ ë‘ë²ˆì§¸ parameterë¥¼ ì˜ë¯¸í•œë‹¤.
#    ã„´ ì¿¼ë¦¬ì˜ ê²°ê³¼ê°’ì—ì„œ ë³´ì—¬ì§ˆ fieldë¥¼ ì •í•¨
#    ã„´ ë³´ì—¬ì¤„ í•„ë“œë¥¼ true, falseë¡œ ì§€ì •
#       ã„´ â­ï¸ tureë¥¼ ì‚¬ìš©í•˜ë©´ tureë§Œ ì„¤ì •í•˜ì í˜¼ì¡ ì ìš© X
```
- ì¡°íšŒ ì˜ˆì‹œ
    - í•„ë“œ ëª…ì´ "article03"ì¸ ì¡°íšŒ ëª©ë¡ì—ì„œ titleì„ ì œì™¸í•œ ë‚˜ë¨¸ì§€ë¥¼ ì¡°íšŒ
        - `db.book.find({ title: "article03" }, { title : false }  );`
    -  nameì´ "yoo" ì´ê³  ageë‘ nameì„ ì œì™¸
    - `db.book.find({ name: "yoo" }, { age: 0, name: 0 });`
        - 0 : ìˆ¨ê¹€ , 1 : ë³´ì—¬ì§ >> ğŸ¤¯ 0, 1 í˜¼í•© ì‚¬ìš© ë¶ˆê°€ëŠ¥
##### $slice ì—°ì‚°ì
- $slice ì—°ì‚°ìëŠ” Document **ë°°ì—´ì˜ limit ì„¤ì •** ì¡°íšŒ
- ì˜ˆì‹œ
  - title ê°’ì´ article03 ì¸ ë°ì´í„°ì˜ ëŒ“ê¸€(comments)ì€ í•˜ë‚˜ë§Œ ë³´ì´ê²Œ ì¶œë ¥
    - `db.book.find( { title: "article03" }, { comments: { $slice: 1 } } )`

#### ë¹„êµ(Comparison) ì—°ì‚°ì

| ì—°ì‚°ì   | ì„¤ëª…                           | ë¶€ë“±í˜¸ í‘œí˜„     | ì‚¬ìš© ì˜ˆì‹œ                                         |
|----------|--------------------------------|-----------------|--------------------------------------------------|
| `$eq`    | ì£¼ì–´ì§„ ê°’ê³¼ ì¼ì¹˜í•˜ëŠ” ê°’        | `=`             | `{ age: { $eq: 25 } }` (ageê°€ 25ì¸ ë¬¸ì„œ ì°¾ê¸°)     |
 | `$ne`    | ì£¼ì–´ì§„ ê°’ê³¼ ì¼ì¹˜í•˜ì§€ ì•ŠëŠ” ê°’    | `!=`            | `{ age: { $ne: 25 } }` (ageê°€ 25ê°€ ì•„ë‹Œ ë¬¸ì„œ ì°¾ê¸°)|
| `$gt`    | ì£¼ì–´ì§„ ê°’ë³´ë‹¤ í° ê°’            | `>`             | `{ age: { $gt: 25 } }` (ageê°€ 25ë³´ë‹¤ í° ë¬¸ì„œ ì°¾ê¸°)|
| `$gte`   | ì£¼ì–´ì§„ ê°’ë³´ë‹¤ í¬ê±°ë‚˜ ê°™ì€ ê°’    | `>=`            | `{ age: { $gte: 25 } }` (ageê°€ 25 ì´ìƒì¸ ë¬¸ì„œ ì°¾ê¸°)|
| `$lt`    | ì£¼ì–´ì§„ ê°’ë³´ë‹¤ ì‘ì€ ê°’          | `<`             | `{ age: { $lt: 25 } }` (ageê°€ 25ë³´ë‹¤ ì‘ì€ ë¬¸ì„œ ì°¾ê¸°)|
| `$lte`   | ì£¼ì–´ì§„ ê°’ë³´ë‹¤ ì‘ê±°ë‚˜ ê°™ì€ ê°’    | `<=`            | `{ age: { $lte: 25 } }` (ageê°€ 25 ì´í•˜ì¸ ë¬¸ì„œ ì°¾ê¸°)|
| `$in`    | ì£¼ì–´ì§„ ë°°ì—´ ì•ˆì— ì†í•˜ëŠ” ê°’      | ê°’ ë¦¬ìŠ¤íŠ¸ í¬í•¨  | `{ age: { $in: [20, 25, 30] } }` (20, 25, 30 ì¤‘ í•˜ë‚˜ ì°¾ê¸°)|
| `$nin`   | ì£¼ì–´ì§„ ë°°ì—´ ì•ˆì— ì†í•˜ì§€ ì•ŠëŠ” ê°’ | ê°’ ë¦¬ìŠ¤íŠ¸ ì œì™¸  | `{ age: { $nin: [20, 25, 30] } }` (20, 25, 30 ì œì™¸)|

- ì¡°íšŒ ì˜ˆì‹œ
  - likes 30 ì´ˆê³¼ 40 ë¯¸ë§Œ: `db.book.find({likes : {$gt : 30, $lt : 40}})`
  - IN ì¡°íšŒ  "Aplpha","Bravo" ê°€ ë“¤ì–´ìˆëŠ” : `db.book.find({ writer: { $in: ["Alpha", "Bravo"] } });`

#### ë…¼ë¦¬(Logical) ì—°ì‚°ì

| ì—°ì‚°ì   | ì„¤ëª…                                      |
|----------|-------------------------------------------|
| `$or`    | **ì£¼ì–´ì§„ ì¡°ê±´ ì¤‘ í•˜ë‚˜ë¼ë„** ì°¸ì´ë©´ ì°¸ì…ë‹ˆë‹¤. |
| `$and`   | **ì£¼ì–´ì§„ ëª¨ë“  ì¡°ê±´ì´** ì°¸ì´ë©´ ì°¸ì…ë‹ˆë‹¤.     |
| `$not`   | **ì£¼ì–´ì§„ ì¡°ê±´ì´** ê±°ì§“ì´ë©´ ì°¸ì…ë‹ˆë‹¤.        |
| `$nor`   | **ì£¼ì–´ì§„ ëª¨ë“  ì¡°ê±´ì´** ê±°ì§“ì´ë©´ ì°¸ì…ë‹ˆë‹¤.   | 

- ì¡°íšŒ ì˜ˆì‹œ
    - title ê°’ì´ â€œarticle01â€ ì´ê±°ë‚˜, writer ê°’ì´ â€œAlphaâ€ ì¸ Document ì¡°íšŒ
      - `db.book.find({ $or : [ {title : "article01"}, {writer : "Alpha"} ] })` 
    - writer ê°’ì´ â€œVelopertâ€ ì´ê³  likes ê°’ì´ 10 ë¯¸ë§Œì¸ Document ì¡°íšŒ
      - `db.book.find({ $and : [ {likes : {$lt : 10}}, {writer : "Velopert"} ] })`

#### $regex ì—°ì‚°ì
```properties
# â„¹ï¸ $regex ì—°ì‚°ìë¥¼ í†µí•´ Documentë¥¼ ì •ê·œì‹ì„ í†µí•´ ì°¾ì„ ìˆ˜ ìˆë‹¤.
#   ã„´> âœï¸ like ê²€ìƒ‰
# { <field>: { $regex: /pattern/, $options: '<options>' } }
# { <field>: { $regex: 'pattern', $options: '<options>' } }
# { <field>: { $regex: /pattern/<options> } }
# { <field>: /pattern/<options> }
```
- ì˜µì…˜ ì¢…ë¥˜
  | **ì˜µì…˜** | **ì„¤ëª…**                                                                 |
  |----------|--------------------------------------------------------------------------|
  | `i`      | ëŒ€ì†Œë¬¸ì ë¬´ì‹œ                                                            |
  | `m`      | ì •ê·œì‹ì—ì„œ anchor(`^`, `$`)ë¥¼ ì‚¬ìš©í•  ë•Œ ê°’ì— `\n`ì´ ìˆìœ¼ë©´ ë¬´ë ¥í™”          |
  | `x`      | ì •ê·œì‹ ì•ˆì— ìˆëŠ” whitespaceë¥¼ ëª¨ë‘ ë¬´ì‹œ                                   |
  | `s`      | dot(`.`) ì‚¬ìš© ì‹œ `\n`ì„ í¬í•¨í•´ì„œ ë§¤ì¹˜                                    |

- ì¡°íšŒ ì˜ˆì‹œ
  - ì ì„±ìì— ê°€ìš´ë° "pha"ê°€ í¬í•¨ëœ ë°ì´í„°
    -  `db.book.find({ writer : { $regex : /pha/ }   })`
  - ì ì„±ìì— ê°€ìš´ë° "pha"ê°€ í¬í•¨ëœ ë°ì´í„° ëŒ€ì†Œë¬¸ì êµ¬ë¶„ X, trim ì ìš©
    -  `db.book.find({ writer: { $regex: /pha/, $options: "ix" } })`
    - ë‚´ì¥í˜•ìœ¼ë¡œ ë³€ê²½
      -  `db.book.find({ writer: { $regex: /pha/ix } })`

#### $elemMatch ì—°ì‚°ì
```properties
# â„¹ï¸ ë°°ì—´ ë‚´ í¬í•¨í•˜ëŠ” ë‚´ìš©ì´ ìˆì„ ê²½ìš° ì¡°íšŒ
```
- ì¡°íšŒ ì˜ˆì‹œ
  - comments(ë°°ì—´) ì¤‘ nameì´ â€œCharlieâ€ ìˆëŠ” ë°ì´í„°
    - `db.book.find({ comments : {  $elemMatch : {  name : "Charlie"}  } })`

#### $exists ì—°ì‚°ì
```properties
# â„¹ï¸ í•´ë‹¹ key ìì²´ê°€ ì¡´ì¬ í•˜ëŠ”ì§€ ì•ˆ í•˜ëŠ”ì§€ boolean ê°’ì„ í†µí•´ ì¡°íšŒ ê°€ëŠ¥
#    ã„´> null ì„ ì°¾ìœ¼ë ¤ë©´  `{$eq : null}` í˜¹ì€ `<field>: null`ì„ ì‚¬ìš©
```
- ì¡°íšŒ ì˜ˆì‹œ
  - comments ë°ì´í„°ê°€ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ê²½ìš°
    - `db.book.find({ comments: { $exists: false } })`

#### $size ì—°ì‚°ì
```properties
# â„¹ï¸ ë°°ì—´ì˜ í¬ê¸°ë¥¼ í™•ì¸
```
- ì¡°íšŒ ì˜ˆì‹œ
  - comments(ë°°ì—´)ì˜ í¬í‚¤ê°€ 1ì¸ ë°ì´í„°
      - `db.book.find({ comments: { $size: 1 } })`


#### ì •ë ¬ ì—°ì‚°ì
```properties
# â„¹ï¸ cursor.sort( DOCUMENT )ë¥¼ ì‚¬ìš©í•´ì„œ ì •ë ¬ì´ ê°€ëŠ¥í•˜ë‹¤.
#   ã„´> 1 ì¼ ê²½ìš° ì˜¤ë¦„ ì°¨ìˆœ // -1 ì¼ ê²½ìš° ë‚´ë¦¼ ì°¨ìˆœ
```
- ì¡°íšŒ ì˜ˆì‹œ
  - id ê¸°ì¤€ ë‚´ë¦¼ ì°¨ìˆœ ì •ë ¬
    - `db.orders.find().sort( {_id : -1})`
  - ê°€ê²©, _Idë§Œ ë³´ì´ê²Œ  ê°€ê²© ê¸°ì¤€ ì˜¤ë¦„ ì°¨ìˆœ ì •ë ¬
    - `db.orders.find({},{ amount : true }).sort( { amount : 1})`

#### ê°œìˆ˜ ì œí•œ ì—°ì‚°ì
```properties
# â„¹ï¸ cursor.limit( value )ì„ ì‚¬ìš©í•´ì„œ ì¶œë ¥í•  ë°ì´í„° ê°¯ìˆ˜ë¥¼ ì œí•œí•  ë•Œ ì‚¬ìš©ë©ë‹ˆë‹¤.
#    ã„´ value íŒŒë¼ë¯¸í„°ëŠ” ì¶œë ¥ í•  ê°¯ìˆ˜ ê°’ ì…ë‹ˆë‹¤.
```
- ì¡°íšŒ ì˜ˆì‹œ
  - 3ê°œë§Œ ë³´ì´ê²Œ ì¡°íšŒ
    - `db.orders.find().limit(3)`

#### skip ì—°ì‚°ì
```properties
# â„¹ï¸ cursor.skip( value )ì„ ì‚¬ìš©í•´ì„œ ì¶œë ¥ í•  ë°ì´í„°ì˜ ì‹œì‘ë¶€ë¶„ì„ ì„¤ì •í•  ë•Œ ì‚¬ìš©ë©ë‹ˆë‹¤.
#    ã„´ value ê°’ ê°¯ìˆ˜ì˜ ë°ì´í„°ë¥¼ ìƒëµí•˜ê³  ê·¸ ë‹¤ìŒë¶€í„° ì¶œë ¥í•©ë‹ˆë‹¤.
```
- ì¡°íšŒ ì˜ˆì‹œ
  - 5ê°œì˜ ë°ì´í„°ë¥¼ ì œì™¸ í›„ ì¡°íšŒ
    - `db.orders.find().skip(5)`

#### ì‘ìš© (í˜ì´ì§•) - limit, skip í™œìš©
- ì¡°íšŒ ì˜ˆì‹œ
  - `orders` ì»¬ë ‰ì…˜ì—ì„œ `_id`ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬í•œ í›„, íŠ¹ì • í˜ì´ì§€ì˜ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” ì¿¼ë¦¬
      - ```javascript
        db.orders.find()                            // ì „ì²´ ë°ì´í„° ì¡°íšŒ
            .sort( { "_id": -1 } )                  // ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬
            .skip( (page - 1) * 10 )                // í˜ì´ì§€ ìŠ¤í‚µ (1í˜ì´ì§€ë‹¹ 10ê°œ)
            .limit(10);                             // ìµœëŒ€ 10ê°œ ì¡°íšŒ
        ```

### Document ì‚­ì œ
- ëª…ë ¹ì–´
  - ë‹¨ê±´ ì‚­ì œ : `db.COLLECTION_NAME.deleteOne( ì¡°ê±´ê°’ )`
    - Ex) `db.book.deleteOne({name : "ìœ ì •í˜¸"})`
  - ì—¬ëŸ¬ê°œ  ì‚­ì œ : `db.COLLECTION_NAME.deleteOne( ì¡°ê±´ê°’ )`
    - Ex) `db.book.deleteMany({name : "ìœ ì •í˜¸"})`
  - Document  ì „ì²´ ì‚­ì œ
    - Ex) `db.book.deleteMany({})`


### Document ì—…ë°ì´íŠ¸
```properties
# â„¹ï¸  db.COLLECTION.updateOne( { ì¡°ê±´ }  , $set : { ë³€ê²½ ê°’ } ), updateMany()ë¥¼ ì‚¬ìš©í•´ì„œ Documentì˜ íŠ¹ì • ê°’ì„ ë³€ê²½ ê°€ëŠ¥
#    ã„´ íŠ¹ì • í•„ë“œ ê°’ë§Œ ë³€ê²½ $set ëª…ë ¹ì–´ ì‚¬ìš©
#    ã„´ íŠ¹ì • í•„ë“œ ì œê±° $unset ëª…ë ¹ì–´ ì‚¬ìš©
#
# â„¹ï¸  db.COLLECTION.replaceOne( ì¡°ê±´ , ë³€ê²½ ê°’ ), replaceMany()ë¥¼ ì‚¬ìš©í•´ì„œ Document ê°’ ìì²´ë¥¼ ë³€ê²½ ê°€ëŠ¥
#
# Sample Data
# [
#   { name: "Abet", age: 19 },
#   { name: "Betty", age: 20 },
#   { name: "Charlie", age: 23, skills: [ "mongodb", "nodejs"] },
#   { name: "David", age: 23, score: 20 }
# ]
```

#### íŠ¹ì • field ì—…ë°ì´íŠ¸ í•˜ê¸°
- ì˜ˆì‹œ
  - ë‹¨ê±´ íŠ¹ì • **í•„ë“œ ì—…ë°ì´íŠ¸**
    - "Abet"ì˜ ageë¥¼ "45"ì‚´ë¡œ ë³€ê²½
      - ```javascript
        db.people.updateOne(
          { name: "Abet" },              // ì¡°ê±´
          { $set: { age: 45 } }          // ì—…ë°ì´íŠ¸ ë‚´ìš©
          )
        ```
    - "Abet"ì˜ ageë¥¼ "20"ì‚´ë¡œ ë³€ê²½ í•˜ê³  ì¢…êµ í•„ë“œë¥¼ ì¶”ê°€
      - ```javascript
        db.people.updateOne(
            { name: "Abet" },                      // ì¡°ê±´
            { $set: { age: 20, religion: "none" } } // ì—…ë°ì´íŠ¸ ë‚´ìš©
        )    
        ```
  - ì°¾ëŠ” Document ê°€ ì—†ì„ ê²½ìš° **ìë™ ì¶”ê°€**
    - "Elly" ë°ì´í„°ë¥¼ ë³€ê²½ **ì—†ì„ ê²½ìš° ì¶”ê°€**
      - ```javascript
        db.people.updateOne(
          { name: "Elly" },                    // ì¡°ê±´
          { $set: { name: "Elly", age: 17 } }, // ì—…ë°ì´íŠ¸ ë‚´ìš©
          { upsert: true }                     // ì˜µì…˜
        )
        ```
  - ë‹¨ê±´ íŠ¹ì • **í•„ë“œ ì œê±°**
      - "Abet"ì˜ `age` í•„ë“œë¥¼ ì œê±°
        - ```javascript
          db.people.updateOne(
            { name: "Abet" },              // ì¡°ê±´
            { $unset: { age: true } }      // í•„ë“œ ì œê±°
          )
          ```
  - ë‹¨ê±´ **replace**
      - "Betty" ë¬¸ì„œë¥¼ **ì´ë¦„ì„ "yoo"**, **ë‚˜ì´ë¥¼ "100"ì‚´**, **ì·¨ë¯¸ë¥¼ "coding"**ìœ¼ë¡œ ë³€ê²½
        - ```javascript
          db.people.updateOne(
            { name: "Betty" },                             // ì¡°ê±´
            { name: "yoo", age: 100, hobby: ["coding"] }   // ìƒˆ ë¬¸ì„œ (replace)
          )
          ```
  - íŠ¹ì • ì¡°ê±´ì— ë§ëŠ” ì—¬ëŸ¬ ë°ì´í„° **í•„ë“œ ì—…ë°ì´íŠ¸**
    - ageê°€ 20 ë³´ë‹¤ ë‚®ê±°ë‚˜ ê°™ì€ documentì˜ scoreë¥¼ 9999ë¡œ ì„¤ì •
        - ```javascript
          db.people.updateMany(
            { age: { $lte: 20 } },            // ì¡°ê±´
            { $set: { score: 9999 } }         // ì—…ë°ì´íŠ¸ ë‚´ìš©
          )
          ```
           
#### ë°°ì—´ ê°’ ì¶”ê°€
```properties
# â„¹ï¸ $push ëª…ë ¹ì–´ë¥¼ í†µí•´ ë°°ì—´ ë‚´ ê°’ì„ ì¶”ê°€
#     ã„´ âœ¨ ì¤‘ë³µì„ ë°©ì§€í•˜ê³  ì‹¶ë‹¤ë©´ $addToSet ì‚¬ìš©
#
#   í•´ë‹¹ ëª…ë ¹ì–´ë„ updateOne, updateManyë¥¼ êµ¬ë¶„í•´ì„œ ì‚¬ìš©í•˜ë©´ ë‹¨ê±´ or ë‹¤ê±´ ì—…ë°ì´íŠ¸ ê°€ëŠ¥
```
- ì˜ˆì‹œ
  - (ì¤‘ë³µ í—ˆìš©) nameì´ "Charlie"ì¸ ë°ì´í„°ì— skillsì— "nextjs"ë¥¼ ì¶”ê°€
    - ```javascript
      db.people.updateOne( 
        { name: "Charlie" },             // "name"ì´ "Charlie"ì¸ ë¬¸ì„œ ì°¾ê¸°
        {
          $push: { skills: "nextJs" }    // "skills" ë°°ì—´ì— "nextJs" ê°’ ì¶”ê°€ (ì¤‘ë³µë˜ì§€ ì•Šìœ¼ë©´ ì¶”ê°€)
         }
      );
      ```
  - (ì¤‘ë³µ X) nameì´ "Charlie"ì¸ ë°ì´í„°ì— skillsì— "nextjs"ë¥¼ ì¶”ê°€
      - ```javascript
      db.people.updateOne( 
        { name: "Charlie" },                 // "name"ì´ "Charlie"ì¸ ë¬¸ì„œ ì°¾ê¸°
        {
          $addToSet: { skills: "nextJs" }    // "skills" ë°°ì—´ì— "nextJs" ê°’ ì¶”ê°€ (ì¤‘ë³µë˜ì§€ ì•Šìœ¼ë©´ ì¶”ê°€)
         }
      );
      ```

#### ë°°ì—´ ì—¬ëŸ¬ ê°œì˜ ê°’ ì¶”ê°€
```proplerties
# â„¹ï¸ $push ëª…ë ¹ì–´ë§Œì„ ì‚¬ìš©í•˜ë©´ í•´ë‹¹ ë°°ì—´ ë‚´ í•œê±´ì˜ ë°ì´í„°ë§Œ ì¶”ê°€ê°€ ê°€ëŠ¥í•˜ë‹¤
#   ã„´ $push ëª…ë ¹ì–´ì™€ $each ëª…ë ¹ì–´ë¥¼ í•¨ê»˜ ì‚¬ìš©í•˜ë©´ ë°°ì—´ì— í•˜ë‚˜ ì´ìƒì˜ ë°ì´í„°ë¥¼ ì¶”ê°€ í•  ìˆ˜ ìˆë‹¤. 
#      ã„´ í•´ë‹¹ ëª…ë ¹ì–´ ë˜í•œ ì¤‘ë³µì„ ì œê±° í•´ì„œ ì¶”ê°€í•˜ë¼ë©´ $addToSetë¥¼ ì‚¬ìš©
```
- ì˜ˆì‹œ
  - "Charlie" ì˜ skillsì— "c++" ì™€ "java" ë¥¼ ì¶”ê°€
    - ```javascript
      db.people.updateOne(
        { name : "Charlie" }              // ëŒ€ìƒ ì§€ì •
        , { $push : {
              skills : {                  // set í•„ë“œ ì§€ì •
                  $each : ["c++", "java"] // $eachë¥¼ ì‚¬ìš©í•´ í•˜ë‚˜ ì´ìƒì„ ì¶”ê°€
               }
        } }
      )
      ```